/* --- Paleta de Colores Oficial de Numberblocks (CORREGIDA Y DETALLADA) --- */
:root {
    --nb-1: #e53935; /* Red */
    --nb-2: #fb8c00; /* Orange */
    --nb-3: #fdd835; /* Yellow */
    --nb-4: #43a047; /* Green */
    --nb-5: #1e88e5; /* Blue */
    --nb-6: #8e24aa; /* Indigo */
    /* Rainbow Seven Colors */
    --nb-7-1: #e53935; --nb-7-2: #fb8c00; --nb-7-3: #fdd835;
    --nb-7-4: #43a047; --nb-7-5: #1e88e5; --nb-7-6: #4527a0; /* Indigo */
    --nb-7-7: #673ab7; /* Violet */
    --nb-8: #ec407a; /* Octoblock Pink/Magenta */
    /* Three shades of grey for Nine */
    --nb-9-1: #f5f5f5; --nb-9-2: #e0e0e0; --nb-9-3: #cccccc;
    --nb-10: #ffffff; /* White */
    --nb-12-main: #ffffff; 
    --nb-12-border: #e53935; /* Red border for 12 */
    --nb-12-center: #fb8c00; /* Orange for 12's center */
    --c-fondo: #87CEEB;
    --c-tierra: #98D49A;
    --c-texto: #34495e;
    --c-borde: rgba(0,0,0,0.15);
}

body {
    font-family: 'Nunito', sans-serif;
    background-color: var(--c-tierra);
    color: var(--c-texto);
    margin: 0;
    padding: 20px 0;
}

.background-sky {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 60vh;
    background: linear-gradient(to bottom, var(--c-fondo), #a3d8f1);
    z-index: -1;
}

.game-world {
    position: relative;
    width: 95%;
    max-width: 900px;
    margin: 20px auto;
}

.cloud {
    position: absolute;
    width: 120px;
    height: 40px;
    background: #fff;
    border-radius: 40px;
    opacity: 0.8;
    animation: move-clouds 25s linear infinite;
    z-index: -1;
}
.cloud:before, .cloud:after {
    content: '';
    position: absolute;
    background: #fff;
    width: 50px; height: 50px;
    border-radius: 50%;
    top: -25px; left: 20px;
}
.cloud:after {
    left: auto; right: 20px; top: -20px;
}
.cloud.c1 { top: 10%; left: -150px; transform: scale(0.8); animation-duration: 30s; }
.cloud.c2 { top: 25%; left: -200px; transform: scale(1); animation-duration: 20s; animation-delay: -5s;}

@keyframes move-clouds {
    from { transform: translateX(-150px); }
    to { transform: translateX(1000px); }
}

.game-container {
    width: 100%;
    background-color: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(5px);
    border-radius: 25px;
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
    padding: 30px;
    display: flex;
    flex-direction: column;
    gap: 15px;
    border: 1px solid rgba(255,255,255,0.5);
    position: relative;
    z-index: 2;
    box-sizing: border-box;
}

.challenge-header h1 {
    font-family: 'Fredoka', sans-serif;
    font-size: 2.5rem;
    margin: 0;
    color: #2c3e50;
    text-align: center;
}

.story-bubble {
    background-color: #eaf5ff;
    border-radius: 15px;
    padding: 15px 20px;
    font-size: 1.2rem;
    text-align: center;
    border: 2px dashed #aed6f1;
}

.equation-display {
    font-family: 'Fredoka', sans-serif;
    font-size: 2.5rem;
    font-weight: 700;
    text-align: center;
    padding: 10px;
    color: #3498db;
}
.equation-display .placeholder {
    color: #f39c12;
    display: inline-block;
    width: 50px;
    border-bottom: 4px dotted #f39c12;
}

.construction-area {
    background-color: rgba(248, 249, 250, 0.8);
    border-radius: 20px;
    min-height: 250px;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    overflow: hidden;
    border: 1px solid #e9ecef;
    padding: 20px;
}

.rectangle-grid {
    display: grid;
    gap: 4px;
}

.rectangle-grid .block {
    width: 25px;
    height: 25px;
    opacity: 0;
    transform: scale(0.5);
    animation: pop-in 0.5s ease-out forwards;
    margin: -1px;
}
@keyframes pop-in { to { opacity: 1; transform: scale(1); } }

.toolbox-section {
    background-color: rgba(244, 244, 244, 0.8);
    border-radius: 15px;
    padding: 20px;
}

.toolbox-title {
    font-family: 'Fredoka', sans-serif;
    text-align: center;
    font-size: 1.3rem;
    margin-bottom: 15px;
}

.toolbox {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    align-items: flex-end;
    gap: 20px;
    min-height: 150px;
}

.numberblock {
    cursor: pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    position: relative;
}
.numberblock:hover {
    transform: translateY(-5px) rotate(2deg);
}
.numberblock.selected {
    transform: scale(1.15) rotate(-3deg);
    box-shadow: 0 0 20px var(--nb-3);
    border-radius: 4px;
}
.numberblock.double-selected {
    transform: scale(1.15) rotate(3deg);
    box-shadow: 0 0 20px var(--nb-1);
}

.block {
    width: 25px;
    height: 25px;
    border: 2px solid var(--c-borde);
    margin-top: -2px;
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    box-sizing: border-box;
}
.block:first-child { border-radius: 0 0 4px 4px; }
.block:last-child { border-radius: 4px 4px 0 0; }
.block:only-child { border-radius: 4px; }

.face-container {
    width: 100%;
    height: 100%;
    position: relative;
    display: none;
    justify-content: center;
    align-items: center;
    gap: 4px;
}
.numberblock.has-face .face-container {
    display: flex; 
}

.eye {
    width: 6px;
    height: 6px;
    background-color: #000;
    border-radius: 50%;
    position: relative;
}
.eye::after { /* Eye glint */
    content: '';
    position: absolute;
    width: 2px;
    height: 2px;
    background-color: #fff;
    border-radius: 50%;
    top: 1px;
    left: 1px;
}

/* Official Color Classes */
.c1 { background-color: var(--nb-1); } .c2 { background-color: var(--nb-2); }
.c3 { background-color: var(--nb-3); } .c4 { background-color: var(--nb-4); }
.c5 { background-color: var(--nb-5); } .c6 { background-color: var(--nb-6); }
.c8 { background-color: var(--nb-8); }
.c10 { background-color: var(--nb-10); border: 3px solid var(--nb-1); }

/* Custom Structure for Number 11 */
.nb-11-shape {
    width: 50px; /* 25*2 */
    height: auto; /* Adjusted */
    display: flex;
    align-items: flex-end;
}
.nb-11-shape .stack {
    display: flex;
    flex-direction: column-reverse;
}
.nb-11-shape .white-block { background-color: #fff; border: 2px solid var(--nb-1); }
.nb-11-shape .red-block { background-color: var(--nb-1); }

/* Custom Structure for Number 12 */
.nb-12-shape {
    width: 75px; /* 3*25 */
    height: 100px; /* 4*25 */
    display: grid;
    grid-template-columns: repeat(3, 1fr);
}
.nb-12-shape .block { margin: -1px; }

/* Target Colors for constructed rectangles */
.c24 { background-color: var(--nb-8); }
.c36 { background-color: var(--nb-6); }
.c48 { background-color: var(--nb-4); }
.c50 { background-color: var(--nb-5); }
.c72 { background-color: var(--nb-2); }

/* Other styles remain the same */
.action-button { font-family: 'Fredoka', sans-serif; font-size: 1.5rem; padding: 15px 40px; border-radius: 50px; border: none; background: linear-gradient(45deg, #2ecc71, #27ae60); color: white; cursor: pointer; box-shadow: 0 5px 0 #1e8449; transition: all 0.1s ease-in-out; }
.action-button:active { transform: translateY(3px); box-shadow: 0 2px 0 #1e8449; }
.action-button.next { background: linear-gradient(45deg, #3498db, #2980b9); box-shadow: 0 5px 0 #1f618d; }
.action-button.next:active { box-shadow: 0 2px 0 #1f618d; }

.back-button { 
    font-family: 'Fredoka', sans-serif; 
    font-size: 1.2rem; 
    padding: 10px 25px; 
    border-radius: 50px; 
    border: none; 
    background: linear-gradient(45deg, #95a5a6, #7f8c8d); 
    color: white; 
    cursor: pointer; 
    box-shadow: 0 4px 0 #6c7b7d; 
    transition: all 0.1s ease-in-out; 
    text-decoration: none;
    display: inline-block;
}
.back-button:hover { 
    transform: translateY(-2px); 
    box-shadow: 0 6px 0 #6c7b7d; 
}
.back-button:active {
    transform: translateY(2px);
    box-shadow: 0 2px 0 #6c7b7d;
}

/* --- Navegaci√≥n Final Constructor --- */
.navegacion-final-constructor {
    margin-top: 40px;
    padding: 30px;
    background: linear-gradient(45deg, #e8f8f5, #d5f4e6);
    border-radius: 20px;
    border: 3px solid #1abc9c;
    text-align: center;
}

.mensaje-final-constructor h3 {
    font-family: 'Fredoka', sans-serif;
    font-size: 1.8rem;
    color: #16a085;
    margin-bottom: 10px;
}

.mensaje-final-constructor p {
    font-size: 1.1rem;
    color: #2c3e50;
    margin-bottom: 25px;
}

.botones-final-constructor {
    display: flex;
    gap: 15px;
    justify-content: center;
    flex-wrap: wrap;
}

.boton-final-constructor {
    display: inline-block;
    padding: 15px 20px;
    border-radius: 50px;
    text-decoration: none;
    font-family: 'Fredoka', sans-serif;
    font-weight: 700;
    font-size: 1rem;
    transition: all 0.2s ease;
    border: none;
    cursor: pointer;
    box-shadow: 0 4px 0;
}

.boton-final-constructor:hover {
    transform: translateY(-2px);
}

.boton-final-constructor:active {
    transform: translateY(2px);
}

.boton-final-constructor.boveda {
    background: linear-gradient(45deg, #54a0ff, #2e86de);
    color: white;
    box-shadow: 0 4px 0 #1f618d;
}

.boton-final-constructor.boveda:hover {
    box-shadow: 0 6px 0 #1f618d;
}

.boton-final-constructor.boveda:active {
    box-shadow: 0 2px 0 #1f618d;
}

.boton-final-constructor.dashboard {
    background: linear-gradient(45deg, #ff6b6b, #ee5a52);
    color: white;
    box-shadow: 0 4px 0 #c44569;
}

.boton-final-constructor.dashboard:hover {
    box-shadow: 0 6px 0 #c44569;
}

.boton-final-constructor.dashboard:active {
    box-shadow: 0 2px 0 #c44569;
}

.boton-final-constructor.reiniciar {
    background: linear-gradient(45deg, #f39c12, #e67e22);
    color: white;
    box-shadow: 0 4px 0 #d35400;
}

.boton-final-constructor.reiniciar:hover {
    box-shadow: 0 6px 0 #d35400;
}

.boton-final-constructor.reiniciar:active {
    box-shadow: 0 2px 0 #d35400;
}

@media (max-width: 600px) {
    .botones-final-constructor {
        flex-direction: column;
        align-items: center;
    }
    
    .boton-final-constructor {
        width: 80%;
        text-align: center;
    }
}
#message-area { text-align: center; font-size: 1.3rem; font-weight: bold; min-height: 30px; padding-top: 10px; }
.hidden { display: none; }
.confetti { position: absolute; width: 8px; height: 15px; background-color: red; opacity: 0; animation: fall 3s linear forwards; }
@keyframes fall { 0% { transform: translateY(-10px) rotate(0deg); opacity: 1; } 100% { transform: translateY(300px) rotate(720deg); opacity: 0; } }
